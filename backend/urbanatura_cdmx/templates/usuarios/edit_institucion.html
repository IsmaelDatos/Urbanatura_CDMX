{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login.css' %}">
{% endblock %}

{% block content %}
<div class="edit-profile-container">
  <div class="edit-profile-card">
    <!-- Cabecera -->
    <div class="edit-profile-header">
      <h1>Editar Perfil Institucional</h1>
    </div>

    <!-- Formulario -->
    <form method="POST" class="edit-profile-form">
      {% csrf_token %}

      {# Mensajes flash #}
      {% if messages %}
      <div class="mb-6">
        {% for message in messages %}
        <div class="alert {% if message.tags == 'error' %}alert-error{% else %}alert-success{% endif %}">
          {{ message }}
        </div>
        {% endfor %}
      </div>
      {% endif %}

      <!-- Información de la institución -->
      <div class="form-section">
        <h2><i class="fas fa-building"></i> Información de la Institución</h2>

        <div class="form-group">
          <label for="nombre_institucion">Nombre de la Institución *</label>
          {{ form.nombre_institucion|add_class:"form-control" }}
          {% if form.nombre_institucion.errors %}
          <p class="error-message">{{ form.nombre_institucion.errors.0 }}</p>
          {% endif %}
        </div>

        <div class="form-group rfc-field">
          <label for="rfc">RFC *</label>
          {{ form.rfc|add_class:"form-control" }}
          <p class="rfc-hint">Formato: 3-4 letras, 6 dígitos y 3 caracteres alfanuméricos</p>
          {% if form.rfc.errors %}
          <p class="error-message">{{ form.rfc.errors.0 }}</p>
          {% endif %}
        </div>

        <div class="form-group">
          <label for="email">Correo Electrónico *</label>
          <input id="email" type="email" value="{{ user.email }}" class="form-control" readonly>
        </div>

        <div class="form-group">
          <label for="telefono">Teléfono</label>
          {{ form.telefono|add_class:"form-control" }}
        </div>
      </div>

      <!-- Dirección -->
      <div class="form-section">
        <h2><i class="fas fa-map-marker-alt"></i> Dirección</h2>

        <div class="form-grid">
          <div class="form-group">
            <label for="calle">Calle *</label>
            {{ form.calle|add_class:"form-control" }}
          </div>

          <div class="form-group">
            <label for="num_ext">Número Ext. *</label>
            {{ form.num_ext|add_class:"form-control" }}
          </div>
        </div>

        <div class="form-group">
          <label for="num_int">Número Int.</label>
          {{ form.num_int|add_class:"form-control" }}
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="municipio">Alcaldía/Municipio *</label>
            {{ form.municipio|add_class:"form-control" }}
          </div>

          <div class="form-group">
            <label for="codigo_postal">Código Postal *</label>
            {{ form.codigo_postal|add_class:"form-control" }}
            {% if form.codigo_postal.errors %}
            <p class="error-message">{{ form.codigo_postal.errors.0 }}</p>
            {% endif %}
          </div>
        </div>

        <div class="form-group">
          <label for="referencias">Referencias</label>
          {{ form.referencias|add_class:"form-control" }}
        </div>
      </div>

      <!-- Botones -->
      <div class="form-actions">
        <a href="{% url 'home_ciudadano' %}" class="btn btn-secondary">
          Cancelar
        </a>
        <button type="submit" class="btn btn-primary">
          Guardar Cambios
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/edit_profile.js' %}"></script>
{% endblock %}